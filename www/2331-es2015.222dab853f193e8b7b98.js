(self.webpackChunkhub=self.webpackChunkhub||[]).push([[2331],{52331:function(e,i,t){"use strict";t.r(i),t.d(i,{ActionsPageModule:function(){return Z}});var n=t(38583),o=t(90665),s=t(47823),a=t(10649),l=t(16738),r=t.n(l),d=t(10639),c=t(89985),g=t(80513);function p(e,i){if(1&e&&(d.TgZ(0,"ion-select-option",15),d.TgZ(1,"p"),d._uU(2),d.qZA(),d.qZA()),2&e){const e=i.$implicit;d.s9C("value",null==e?null:e.employee_id),d.xp6(2),d.Oqu(null==e?null:e.full_name)}}function u(e,i){if(1&e){const e=d.EpF();d.TgZ(0,"ion-button",16),d.NdJ("click",function(){return d.CHM(e),d.oxw().onSubmit()}),d._uU(1," SUBMIT "),d.qZA()}}function h(e,i){if(1&e){const e=d.EpF();d.TgZ(0,"ion-button",16),d.NdJ("click",function(){return d.CHM(e),d.oxw().onSubmit()}),d._uU(1," UPDATE "),d.qZA()}}const _=[{path:"",component:(()=>{class e{constructor(e,i,t){this.nav=e,this.global=i,this.loadingService=t,this.pName="Actions",this.data=[],this.description_of_required_action="",this.priority="",this.expected_completion="",this.loggedInUser=""}ngOnInit(){this.loggedInUser=JSON.parse(localStorage.getItem("userDetails"));let e=JSON.parse(localStorage.getItem("singleView"));this.incident_id=e.id,this.loadEmp()}loadEmp(){this.loadingService.presentLoading(),this.global.getData("user/getAllUser").subscribe(e=>{e&&e.data&&(this.data=e.data),this.loadingService.dismissLoading(),console.log("this.data ",this.data)},e=>{this.loadingService.dismissLoading(),console.log(e)})}ionViewWillEnter(){let e=localStorage.getItem("isActionsForm");this.isFrom=e,"edit"==e&&(JSON.parse(localStorage.getItem("singleView")),console.log("  this.incident_id ",this.incident_id),this.global.getData("Investigator/getInvestigationAction/"+this.loggedInUser.id).subscribe(e=>{var i;console.log("getInvestigationAction 1",e),e&&(null===(i=null==e?void 0:e.data)||void 0===i||i.forEach(e=>{console.log("getInvestigationAction 2",e),e.incident_id==this.incident_id&&(console.log("here"),this.description_of_required_action=e.description_of_required_action,this.user_name=e.user_id,this.priority=e.priority,this.expected_completion=e.expected_completion,this.id=e.id,console.log(" this.id ",this.id))}))},e=>{console.log("res",e)}))}goBack(){this.nav.back()}selectUser(e){this.data.forEach(i=>{i.employee_id==e.detail.value&&(this.user_id=i.full_name)})}dateSelect(e){this.expected_completion=r()(e.detail.value).format("YYYY-MM-DD")}onSubmit(){let e=JSON.parse(localStorage.getItem("userDetails"));if(""==this.description_of_required_action)this.global.presentToast("Please enter description of required action");else if(""==this.user_name)this.global.presentToast("Please Select User");else if(""==this.priority)this.global.presentToast("Please select the priority");else if(""==this.expected_completion)this.global.presentToast("Please enter expected completion");else{this.global.presentLoading();const i=new FormData;"edit"==this.isFrom&&i.append("id",this.id),i.append("incident_id",this.incident_id),i.append("user_id",this.user_name),i.append("user_name",this.user_id),i.append("priority",this.priority),i.append("expected_completion",this.expected_completion),i.append("description_of_required_action",this.description_of_required_action),i.append("investigator_id",e.id),this.global.postData("Investigator/InvestigationAction",i).subscribe(e=>{e.status?(this.global.presentToast(e.message),this.global.dismissLoading(),this.nav.back()):this.global.dismissLoading()},e=>{console.log(e),this.global.dismissLoading()})}}}return e.\u0275fac=function(i){return new(i||e)(d.Y36(s.SH),d.Y36(c.U),d.Y36(g.b))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-actions"]],decls:33,vars:7,consts:[[1,"container"],[1,"ion-padding-start","ion-padding-end"],[1,"question"],["placeholder","Enter here",3,"ngModel","ngModelChange"],["lines","none",1,"ra","ion-no-margin","ion-no-padding"],["placeholder","Select One","interface","action-sheet",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[1,"ion-no-padding"],["size","4",1,"ion-no-padding"],["lines","none",1,"ra"],["slot","start","value","Minor"],["slot","start","value","Major"],["displayFormat","DD/MM/YYYY","placeholder","Select date",3,"ngModel","ionChange","ngModelChange"],["class","btn","type","submit",3,"click",4,"ngIf"],[3,"value"],["type","submit",1,"btn",3,"click"]],template:function(e,i){1&e&&(d.TgZ(0,"ion-content"),d.TgZ(1,"div",0),d.TgZ(2,"ion-card"),d.TgZ(3,"ion-card-content"),d.TgZ(4,"div",1),d.TgZ(5,"p",2),d._uU(6," Description of Required Action "),d.qZA(),d.TgZ(7,"ion-input",3),d.NdJ("ngModelChange",function(e){return i.description_of_required_action=e}),d.qZA(),d.TgZ(8,"p",2),d._uU(9,"Allocated to"),d.qZA(),d.TgZ(10,"ion-item",4),d.TgZ(11,"ion-select",5),d.NdJ("ngModelChange",function(e){return i.user_name=e})("ionChange",function(e){return i.selectUser(e)}),d.YNc(12,p,3,2,"ion-select-option",6),d.qZA(),d.qZA(),d.TgZ(13,"p",2),d._uU(14,"Priority"),d.qZA(),d.TgZ(15,"ion-radio-group",7),d.NdJ("ngModelChange",function(e){return i.priority=e}),d.TgZ(16,"ion-row",8),d.TgZ(17,"ion-col",9),d.TgZ(18,"ion-item",10),d.TgZ(19,"ion-label"),d._uU(20,"Minor"),d.qZA(),d._UZ(21,"ion-radio",11),d.qZA(),d.qZA(),d.TgZ(22,"ion-col",9),d.TgZ(23,"ion-item",10),d.TgZ(24,"ion-label"),d._uU(25,"Major"),d.qZA(),d._UZ(26,"ion-radio",12),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(27,"p",2),d._uU(28,"Expected completion"),d.qZA(),d.TgZ(29,"ion-item",10),d.TgZ(30,"ion-datetime",13),d.NdJ("ionChange",function(e){return i.dateSelect(e)})("ngModelChange",function(e){return i.expected_completion=e}),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(31,u,2,0,"ion-button",14),d.YNc(32,h,2,0,"ion-button",14),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.Q6J("ngModel",i.description_of_required_action),d.xp6(4),d.Q6J("ngModel",i.user_name),d.xp6(1),d.Q6J("ngForOf",i.data),d.xp6(3),d.Q6J("ngModel",i.priority),d.xp6(15),d.Q6J("ngModel",i.expected_completion),d.xp6(1),d.Q6J("ngIf","add"==i.isFrom),d.xp6(1),d.Q6J("ngIf","edit"==i.isFrom))},directives:[s.W2,s.PM,s.FN,s.pK,s.j9,o.JJ,o.On,s.Ie,s.t9,s.QI,n.sg,s.se,s.Nd,s.wI,s.Q$,s.B7,s.U5,s.x4,n.O5,s.n0,s.YG],styles:[""]}),e})()}];let m=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[a.Bz.forChild(_)],a.Bz]}),e})(),Z=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[n.ez,o.u5,s.Pc,m]]}),e})()}}]);